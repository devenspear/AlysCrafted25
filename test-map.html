<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Map Modal Test</title>
  <style>
    body {
      font-family: system-ui;
      padding: 20px;
    }
    .btn {
      padding: 12px 20px;
      background: #004978;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      margin: 10px;
    }
    .btn:hover {
      background: #003a60;
    }
    .map-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.95);
      z-index: 2000;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 0;
      overflow: hidden;
    }
    .map-modal.active {
      display: flex;
    }
    .map-modal-content {
      position: relative;
      width: 100%;
      height: 100%;
      background: #000000;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: auto;
    }
    .map-modal-close {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #004978;
      color: #FFFFFF;
      border: none;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2001;
      box-shadow: 0 4px 12px rgba(0,0,0,0.5);
      font-weight: 300;
      line-height: 1;
    }
    .map-modal-close:active {
      background: #003a60;
      transform: scale(0.95);
    }
    .map-modal-img {
      max-width: 100%;
      max-height: 100%;
      width: auto;
      height: auto;
      object-fit: contain;
      display: block;
      margin: auto;
      touch-action: pinch-zoom;
    }
    .log {
      margin: 10px 0;
      padding: 10px;
      background: #f0f0f0;
      border-left: 4px solid #004978;
      font-family: monospace;
      font-size: 12px;
    }
  </style>
</head>
<body>
  <h1>Map Modal Test</h1>

  <button class="btn" id="showMapBtn">üìç Show Map (Method 1)</button>
  <button class="btn" onclick="testOpenMap()">üìç Show Map (Method 2 - onclick)</button>

  <div id="logs"></div>

  <!-- Map Modal -->
  <div class="map-modal" id="mapModal">
    <div class="map-modal-content">
      <button class="map-modal-close" id="closeMapBtn">√ó</button>
      <img class="map-modal-img" src="2025 CRAFTED MAP.jpg" alt="Crafted 2025 Event Map">
    </div>
  </div>

  <script>
    function log(msg) {
      const logs = document.getElementById('logs');
      const div = document.createElement('div');
      div.className = 'log';
      div.textContent = new Date().toLocaleTimeString() + ': ' + msg;
      logs.insertBefore(div, logs.firstChild);
      console.log(msg);
    }

    log('Script loaded');

    // Method 1: getElementById
    function openMapModal() {
      log('openMapModal() called');
      const modal = document.getElementById("mapModal");
      if (!modal) {
        log('ERROR: Modal element not found!');
        return;
      }
      log('Modal element found: ' + modal.tagName);

      modal.classList.add("active");
      log('Added "active" class to modal');

      const computedDisplay = window.getComputedStyle(modal).display;
      log('Modal display style: ' + computedDisplay);

      document.body.style.overflow = "hidden";
      document.body.style.position = "fixed";
      document.body.style.width = "100%";
      log('Body styles set');
    }

    function closeMapModal() {
      log('closeMapModal() called');
      const modal = document.getElementById("mapModal");
      if (!modal) {
        log('ERROR: Modal element not found!');
        return;
      }
      modal.classList.remove("active");
      document.body.style.overflow = "";
      document.body.style.position = "";
      document.body.style.width = "";
      log('Modal closed');
    }

    // Test method 2
    function testOpenMap() {
      log('testOpenMap() called via onclick');
      openMapModal();
    }

    // Attach listeners
    const mapBtn = document.getElementById("showMapBtn");
    const closeBtn = document.getElementById("closeMapBtn");

    if (!mapBtn) {
      log('ERROR: Map button (#showMapBtn) not found!');
    } else {
      log('Map button found, attaching listener');
      mapBtn.addEventListener("click", function(e) {
        log('Map button CLICKED!');
        e.preventDefault();
        openMapModal();
      });
    }

    if (!closeBtn) {
      log('ERROR: Close button (#closeMapBtn) not found!');
    } else {
      log('Close button found, attaching listener');
      closeBtn.addEventListener("click", function(e) {
        log('Close button CLICKED!');
        e.preventDefault();
        closeMapModal();
      });
    }

    // Click outside modal to close
    const mapModal = document.getElementById("mapModal");
    if (mapModal) {
      mapModal.addEventListener("click", function(e) {
        if (e.target === mapModal || e.target.classList.contains("map-modal-content")) {
          log('Clicked outside modal content, closing...');
          closeMapModal();
        }
      });
    }

    // Escape key to close
    document.addEventListener("keydown", function(e) {
      if (e.key === "Escape") {
        log('Escape key pressed, closing modal');
        closeMapModal();
      }
    });

    log('All listeners attached');
    log('Ready to test!');
  </script>
</body>
</html>
